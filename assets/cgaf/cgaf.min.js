/**
**//*!
 * jQuery Form Plugin
 * version: 3.03 (08-MAR-2012)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 *//*global ActiveXObject alert */(function(a){function e(){if(!!a.fn.ajaxSubmit.debug){var b="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.postError&&window.opera.postError(b)}}function d(b){var c=b.target,d=a(c);if(!d.is(":submit,input:image")){var e=d.closest(":submit");if(e.length===0)return;c=e[0]}var f=this;f.clk=c;if(c.type=="image")if(b.offsetX!==undefined)f.clk_x=b.offsetX,f.clk_y=b.offsetY;else if(typeof a.fn.offset=="function"){var g=d.offset();f.clk_x=b.pageX-g.left,f.clk_y=b.pageY-g.top}else f.clk_x=b.pageX-c.offsetLeft,f.clk_y=b.pageY-c.offsetTop;setTimeout(function(){f.clk=f.clk_x=f.clk_y=null},100)}function c(b){var c=b.data;b.isDefaultPrevented()||(b.preventDefault(),a(this).ajaxSubmit(c))}"use strict";var b={};b.fileapi=a("<input type='file'/>").get(0).files!==undefined,b.formdata=window.FormData!==undefined,a.fn.ajaxSubmit=function(c){function w(b){function E(b){if(!o.aborted&&!D){try{B=w(n)}catch(c){e("cannot access response document: ",c),b=v}if(b===u&&o){o.abort("timeout");return}if(b==v&&o){o.abort("server abort");return}if(!B||B.location.href==j.iframeSrc)if(!r)return;n.detachEvent?n.detachEvent("onload",E):n.removeEventListener("load",E,!1);var d="success",f;try{if(r)throw"timeout";var g=j.dataType=="xml"||B.XMLDocument||a.isXMLDoc(B);e("isXml="+g);if(!g&&window.opera&&(B.body===null||!B.body.innerHTML)&&--C){e("requeing onLoad callback, DOM not available"),setTimeout(E,250);return}var h=B.body?B.body:B.documentElement;o.responseText=h?h.innerHTML:null,o.responseXML=B.XMLDocument?B.XMLDocument:B,g&&(j.dataType="xml"),o.getResponseHeader=function(a){var b={"content-type":j.dataType};return b[a]},h&&(o.status=Number(h.getAttribute("status"))||o.status,o.statusText=h.getAttribute("statusText")||o.statusText);var i=(j.dataType||"").toLowerCase(),l=/(json|script|text)/.test(i);if(l||j.textarea){var p=B.getElementsByTagName("textarea")[0];if(p)o.responseText=p.value,o.status=Number(p.getAttribute("status"))||o.status,o.statusText=p.getAttribute("statusText")||o.statusText;else if(l){var q=B.getElementsByTagName("pre")[0],t=B.getElementsByTagName("body")[0];q?o.responseText=q.textContent?q.textContent:q.innerText:t&&(o.responseText=t.textContent?t.textContent:t.innerText)}}else i=="xml"&&!o.responseXML&&o.responseText&&(o.responseXML=F(o.responseText));try{A=H(o,i,j)}catch(b){d="parsererror",o.error=f=b||d}}catch(b){e("error caught: ",b),d="error",o.error=f=b||d}o.aborted&&(e("upload aborted"),d=null),o.status&&(d=o.status>=200&&o.status<300||o.status===304?"success":"error"),d==="success"?(j.success&&j.success.call(j.context,A,"success",o),k&&a.event.trigger("ajaxSuccess",[o,j])):d&&(f===undefined&&(f=o.statusText),j.error&&j.error.call(j.context,o,d,f),k&&a.event.trigger("ajaxError",[o,j,f])),k&&a.event.trigger("ajaxComplete",[o,j]),k&&!--a.active&&a.event.trigger("ajaxStop"),j.complete&&j.complete.call(j.context,o,d),D=!0,j.timeout&&clearTimeout(s),setTimeout(function(){j.iframeTarget||m.remove(),o.responseXML=null},100)}}function z(){function g(){try{var a=w(n).readyState;e("state = "+a),a&&a.toLowerCase()=="uninitialized"&&setTimeout(g,50)}catch(b){e("Server abort: ",b," (",b.name,")"),E(v),s&&clearTimeout(s),s=undefined}}var b=h.attr("target"),c=h.attr("action");f.setAttribute("target",l),d||f.setAttribute("method","POST"),c!=j.url&&f.setAttribute("action",j.url),!j.skipEncodingOverride&&(!d||/post/i.test(d))&&h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),j.timeout&&(s=setTimeout(function(){r=!0,E(u)},j.timeout));var i=[];try{if(j.extraData)for(var k in j.extraData)j.extraData.hasOwnProperty(k)&&i.push(a('<input type="hidden" name="'+k+'">').attr("value",j.extraData[k]).appendTo(f)[0]);j.iframeTarget||(m.appendTo("body"),n.attachEvent?n.attachEvent("onload",E):n.addEventListener("load",E,!1)),setTimeout(g,15),f.submit()}finally{f.setAttribute("action",c),b?f.setAttribute("target",b):h.removeAttr("target"),a(i).remove()}}function w(a){var b=a.contentWindow?a.contentWindow.document:a.contentDocument?a.contentDocument:a.document;return b}var f=h[0],g,i,j,k,l,m,n,o,p,q,r,s,t=!!a.fn.prop;if(b)if(t)for(i=0;i<b.length;i++)g=a(f[b[i].name]),g.prop("disabled",!1);else for(i=0;i<b.length;i++)g=a(f[b[i].name]),g.removeAttr("disabled");if(a(":input[name=submit],:input[id=submit]",f).length)alert('Error: Form elements must not have name or id of "submit".');else{j=a.extend(!0,{},a.ajaxSettings,c),j.context=j.context||j,l="jqFormIO"+(new Date).getTime(),j.iframeTarget?(m=a(j.iframeTarget),q=m.attr("name"),q?l=q:m.attr("name",l)):(m=a('<iframe name="'+l+'" src="'+j.iframeSrc+'" />'),m.css({position:"absolute",top:"-1000px",left:"-1000px"})),n=m[0],o={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(b){var c=b==="timeout"?"timeout":"aborted";e("aborting upload... "+c),this.aborted=1,m.attr("src",j.iframeSrc),o.error=c,j.error&&j.error.call(j.context,o,c,b),k&&a.event.trigger("ajaxError",[o,j,c]),j.complete&&j.complete.call(j.context,o,c)}},k=j.global,k&&0===a.active++&&a.event.trigger("ajaxStart"),k&&a.event.trigger("ajaxSend",[o,j]);if(j.beforeSend&&j.beforeSend.call(j.context,o,j)===!1){j.global&&a.active--;return}if(o.aborted)return;p=f.clk,p&&(q=p.name,q&&!p.disabled&&(j.extraData=j.extraData||{},j.extraData[q]=p.value,p.type=="image"&&(j.extraData[q+".x"]=f.clk_x,j.extraData[q+".y"]=f.clk_y)));var u=1,v=2,x=a("meta[name=csrf-token]").attr("content"),y=a("meta[name=csrf-param]").attr("content");y&&x&&(j.extraData=j.extraData||{},j.extraData[y]=x),j.forceSync?z():setTimeout(z,10);var A,B,C=50,D,F=a.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&b.documentElement.nodeName!="parsererror"?b:null},G=a.parseJSON||function(a){return window.eval("("+a+")")},H=function(b,c,d){var e=b.getResponseHeader("content-type")||"",f=c==="xml"||!c&&e.indexOf("xml")>=0,g=f?b.responseXML:b.responseText;f&&g.documentElement.nodeName==="parsererror"&&a.error&&a.error("parsererror"),d&&d.dataFilter&&(g=d.dataFilter(g,c)),typeof g=="string"&&(c==="json"||!c&&e.indexOf("json")>=0?g=G(g):(c==="script"||!c&&e.indexOf("javascript")>=0)&&a.globalEval(g));return g}}}function v(b){var d=new FormData;for(var e=0;e<b.length;e++)d.append(b[e].name,b[e].value);if(c.extraData)for(var f in c.extraData)c.extraData.hasOwnProperty(f)&&d.append(f,c.extraData[f]);c.data=null;var g=a.extend(!0,{},a.ajaxSettings,c,{contentType:!1,processData:!1,cache:!1,type:"POST"});c.uploadProgress&&(g.xhr=function(){var a=jQuery.ajaxSettings.xhr();a.upload&&(a.upload.onprogress=function(a){var b=0;a.lengthComputable&&(b=parseInt(a.position/a.total*100,10)),c.uploadProgress(a,a.position,a.total,b)});return a}),g.data=null;var h=g.beforeSend;g.beforeSend=function(a,b){b.data=d,h&&h.call(b,a,c)},a.ajax(g)}if(!this.length){e("ajaxSubmit: skipping submit process - no element selected");return this}var d,f,g,h=this;typeof c=="function"&&(c={success:c}),d=this.attr("method"),f=this.attr("action"),g=typeof f=="string"?a.trim(f):"",g=g||window.location.href||"",g&&(g=(g.match(/^([^#]+)/)||[])[1]),c=a.extend(!0,{url:g,success:a.ajaxSettings.success,type:d||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},c);var i={};this.trigger("form-pre-serialize",[this,c,i]);if(i.veto){e("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(c.beforeSerialize&&c.beforeSerialize(this,c)===!1){e("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var j=c.traditional;j===undefined&&(j=a.ajaxSettings.traditional);var k,l=this.formToArray(c.semantic);c.data&&(c.extraData=c.data,k=a.param(c.data,j));if(c.beforeSubmit&&c.beforeSubmit(l,this,c)===!1){e("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[l,this,c,i]);if(i.veto){e("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var m=a.param(l,j);k&&(m=m?m+"&"+k:k),c.type.toUpperCase()=="GET"?(c.url+=(c.url.indexOf("?")>=0?"&":"?")+m,c.data=null):c.data=m;var n=[];c.resetForm&&n.push(function(){h.resetForm()}),c.clearForm&&n.push(function(){h.clearForm(c.includeHidden)});if(!c.dataType&&c.target){var o=c.success||function(){};n.push(function(b){var d=c.replaceTarget?"replaceWith":"html";a(c.target)[d](b).each(o,arguments)})}else c.success&&n.push(c.success);c.success=function(a,b,d){var e=c.context||c;for(var f=0,g=n.length;f<g;f++)n[f].apply(e,[a,b,d||h,h])};var p=a("input:file:enabled[value]",this),q=p.length>0,r="multipart/form-data",s=h.attr("enctype")==r||h.attr("encoding")==r,t=b.fileapi&&b.formdata;e("fileAPI :"+t);var u=(q||s)&&!t;c.iframe!==!1&&(c.iframe||u)?c.closeKeepAlive?a.get(c.closeKeepAlive,function(){w(l)}):w(l):(q||s)&&t?v(l):a.ajax(c),this.trigger("form-submit-notify",[this,c]);return this},a.fn.ajaxForm=function(b){b=b||{},b.delegation=b.delegation&&a.isFunction(a.fn.on);if(!b.delegation&&this.length===0){var f={s:this.selector,c:this.context};if(!a.isReady&&f.s){e("DOM not ready, queuing ajaxForm"),a(function(){a(f.s,f.c).ajaxForm(b)});return this}e("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)"));return this}if(b.delegation){a(document).off("submit.form-plugin",this.selector,c).off("click.form-plugin",this.selector,d).on("submit.form-plugin",this.selector,b,c).on("click.form-plugin",this.selector,b,d);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",b,c).bind("click.form-plugin",b,d)},a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},a.fn.formToArray=function(c){var d=[];if(this.length===0)return d;var e=this[0],f=c?e.getElementsByTagName("*"):e.elements;if(!f)return d;var g,h,i,j,k,l,m;for(g=0,l=f.length;g<l;g++){k=f[g],i=k.name;if(!i)continue;if(c&&e.clk&&k.type=="image"){!k.disabled&&e.clk==k&&(d.push({name:i,value:a(k).val(),type:k.type}),d.push({name:i+".x",value:e.clk_x},{name:i+".y",value:e.clk_y}));continue}j=a.fieldValue(k,!0);if(j&&j.constructor==Array)for(h=0,m=j.length;h<m;h++)d.push({name:i,value:j[h]});else if(b.fileapi&&k.type=="file"&&!k.disabled){var n=k.files;for(h=0;h<n.length;h++)d.push({name:i,value:n[h],type:k.type})}else j!==null&&typeof j!="undefined"&&d.push({name:i,value:j,type:k.type})}if(!c&&e.clk){var o=a(e.clk),p=o[0];i=p.name,i&&!p.disabled&&p.type=="image"&&(d.push({name:i,value:o.val()}),d.push({name:i+".x",value:e.clk_x},{name:i+".y",value:e.clk_y}))}return d},a.fn.formSerialize=function(b){return a.param(this.formToArray(b))},a.fn.fieldSerialize=function(b){var c=[];this.each(function(){var d=this.name;if(!!d){var e=a.fieldValue(this,b);if(e&&e.constructor==Array)for(var f=0,g=e.length;f<g;f++)c.push({name:d,value:e[f]});else e!==null&&typeof e!="undefined"&&c.push({name:this.name,value:e})}});return a.param(c)},a.fn.fieldValue=function(b){for(var c=[],d=0,e=this.length;d<e;d++){var f=this[d],g=a.fieldValue(f,b);if(g===null||typeof g=="undefined"||g.constructor==Array&&!g.length)continue;g.constructor==Array?a.merge(c,g):c.push(g)}return c},a.fieldValue=function(b,c){var d=b.name,e=b.type,f=b.tagName.toLowerCase();c===undefined&&(c=!0);if(c&&(!d||b.disabled||e=="reset"||e=="button"||(e=="checkbox"||e=="radio")&&!b.checked||(e=="submit"||e=="image")&&b.form&&b.form.clk!=b||f=="select"&&b.selectedIndex==-1))return null;if(f=="select"){var g=b.selectedIndex;if(g<0)return null;var h=[],i=b.options,j=e=="select-one",k=j?g+1:i.length;for(var l=j?g:0;l<k;l++){var m=i[l];if(m.selected){var n=m.value;n||(n=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value);if(j)return n;h.push(n)}}return h}return a(b).val()},a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b)})},a.fn.clearFields=a.fn.clearInputs=function(a){var b=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var c=this.type,d=this.tagName.toLowerCase();b.test(c)||d=="textarea"||a&&/hidden/.test(c)?this.value="":c=="checkbox"||c=="radio"?this.checked=!1:d=="select"&&(this.selectedIndex=-1)})},a.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},a.fn.enable=function(a){a===undefined&&(a=!0);return this.each(function(){this.disabled=!a})},a.fn.selected=function(b){b===undefined&&(b=!0);return this.each(function(){var c=this.type;if(c=="checkbox"||c=="radio")this.checked=b;else if(this.tagName.toLowerCase()=="option"){var d=a(this).parent("select");b&&d[0]&&d[0].type=="select-one"&&d.find("option").selected(!1),this.selected=b}})},a.fn.ajaxSubmit.debug=!1})(jQuery),function(a){a.extend(a.fn,{validate:function(b){if(!this.length)b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");else{var c=a.data(this[0],"validator");if(c)return c;this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c),c.settings.onsubmit&&(this.validateDelegate(":submit","click",function(b){c.settings.submitHandler&&(c.submitButton=b.target),a(b.target).hasClass("cancel")&&(c.cancelSubmit=!0)}),this.submit(function(b){function d(){var d;if(c.settings.submitHandler){c.submitButton&&(d=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm)),c.settings.submitHandler.call(c,c.currentForm,b),c.submitButton&&d.remove();return!1}return!0}c.settings.debug&&b.preventDefault();if(c.cancelSubmit){c.cancelSubmit=!1;return d()}if(c.form()){if(c.pendingRequest){c.formSubmitted=!0;return!1}return d()}c.focusInvalid();return!1}));return c}},valid:function(){if(a(this[0]).is("form"))return this.validate().form();var b=!0,c=a(this[0].form).validate();this.each(function(){b&=c.element(this)});return b},removeAttrs:function(b){var c={},d=this;a.each(b.split(/\s/),function(a,b){c[b]=d.attr(b),d.removeAttr(b)});return c},rules:function(b,c){var d=this[0];if(b){var e=a.data(d.form,"validator").settings,f=e.rules,g=a.validator.staticRules(d);switch(b){case"add":a.extend(g,a.validator.normalizeRule(c)),f[d.name]=g,c.messages&&(e.messages[d.name]=a.extend(e.messages[d.name],c.messages));break;case"remove":if(!c){delete f[d.name];return g}var h={};a.each(c.split(/\s/),function(a,b){h[b]=g[b],delete g[b]});return h}}var i=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(d),a.validator.classRules(d),a.validator.attributeRules(d),a.validator.staticRules(d)),d);if(i.required){var j=i.required;delete i.required,i=a.extend({required:j},i)}return i}}),a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+b.value)},filled:function(b){return!!a.trim(""+b.value)},unchecked:function(a){return!a.checked}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){if(arguments.length===1)return function(){var c=a.makeArray(arguments);c.unshift(b);return a.validator.format.apply(this,c)};arguments.length>2&&c.constructor!==Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!==Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),c)});return b},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a,b){this.lastActive=a,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(a)).hide())},onfocusout:function(a,b){!this.checkable(a)&&(a.name in this.submitted||!this.optional(a))&&this.element(a)},onkeyup:function(a,b){(a.name in this.submitted||a===this.lastElement)&&this.element(a)},onclick:function(a,b){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function d(b){var c=a.data(this[0].form,"validator"),d="on"+b.type.replace(/^validate/,"");c.settings[d]&&c.settings[d].call(c,this[0],b)}this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var b=this.groups={};a.each(this.settings.groups,function(c,d){a.each(d.split(/\s/),function(a,d){b[d]=c})});var c=this.settings.rules;a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",d).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",d),this.settings.invalidHandler&&a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){b=this.validationTargetFor(this.clean(b)),this.lastElement=b,this.prepareElement(b),this.currentElements=a(b);var c=this.check(b)!==!1;c?delete this.invalid[b.name]:this.invalid[b.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors();return c},showErrors:function(b){if(b){a.extend(this.errorMap,b),this.errorList=[];for(var c in b)this.errorList.push({message:b[c],element:this.findByName(c)[0]});this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0;for(var c in a)b++;return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()===0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(a){return a.element.name===b.name}).length===1&&b},elements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in c||!b.objectLength(a(this).rules()))return!1;c[this.name]=!0;return!0})},clean:function(b){return a(b)[0]},errors:function(){var b=this.settings.errorClass.replace(" ",".");return a(this.settings.errorElement+"."+b,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([]),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},elementValue:function(b){var c=a(b).val();if(typeof c=="string")return c.replace(/\r/g,"");return c},check:function(b){b=this.validationTargetFor(this.clean(b));var c=a(b).rules(),d=!1,e=this.elementValue(b),f;for(var g in c){var h={method:g,parameters:c[g]};try{f=a.validator.methods[g].call(this,e,b,h.parameters);if(f==="dependency-mismatch"){d=!0;continue}d=!1;if(f==="pending"){this.toHide=this.toHide.not(this.errorsFor(b));return}if(!f){this.formatAndAdd(b,h);return!1}}catch(i){this.settings.debug&&window.console&&console.log("exception occured when checking element "+b.id+", check the '"+h.method+"' method",i);throw i}}if(!d){this.objectLength(c)&&this.successList.push(b);return!0}},customMetaMessage:function(b,c){if(!!a.metadata){var d=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return d&&d.messages&&d.messages[c]}},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor===String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==undefined)return arguments[a];return undefined},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(b,c){var d=this.defaultMessage(b,c.method),e=/\$?\{(\d+)\}/g;typeof d=="function"?d=d.call(this,c.parameters,b):e.test(d)&&(d=a.validator.format(d.replace(e,"{$1}"),c.parameters)),this.errorList.push({message:d,element:b}),this.errorMap[b.name]=d,this.submitted[b.name]=d},addWrapper:function(a){this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper)));return a},defaultShowErrors:function(){var a,b;for(a=0;this.errorList[a];a++){var c=this.errorList[a];this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass),this.showLabel(c.element,c.message)}this.errorList.length&&(this.toShow=this.toShow.add(this.containers));if(this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(a=0,b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d=this.errorsFor(b);d.length?(d.removeClass(this.settings.validClass).addClass(this.settings.errorClass),d.attr("generated")&&d.html(c)):(d=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(b),generated:!0}).addClass(this.settings.errorClass).html(c||""),this.settings.wrapper&&(d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b))),!c&&this.settings.success&&(d.text(""),typeof this.settings.success=="string"?d.addClass(this.settings.success):this.settings.success(d)),this.toShow=this.toShow.add(d)},errorsFor:function(b){var c=this.idOrName(b);return this.errors().filter(function(){return a(this).attr("for")===c})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){this.checkable(a)&&(a=this.findByName(a.name).not(this.settings.ignore)[0]);return a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){var c=this.currentForm;return a(document.getElementsByName(b)).map(function(a,d){return d.form===c&&d.name===b&&d||null})},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a,b){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){var c=this.elementValue(b);return!a.validator.methods.required.call(this,c,b)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],c&&this.pendingRequest===0&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.formSubmitted=!1):!c&&this.pendingRequest===0&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor===String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])});return c},attributeRules:function(b){var c={},d=a(b);for(var e in a.validator.methods){var f;e==="required"?(f=d.get(0).getAttribute(e),f===""&&(f=!0),f=!!f):f=d.attr(e),f?c[e]=f:d[0].getAttribute("type")===e&&(c[e]=!0)}c.maxlength&&/-1|2147483647|524288/.test(c.maxlength)&&delete c.maxlength;return c},metadataRules:function(b){if(!a.metadata)return{};var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:a(b).metadata()},staticRules:function(b){var c={},d=a.data(b.form,"validator");d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[b.name])||{});return c},normalizeRules:function(b,c){a.each(b,function(d,e){if(e===!1)delete b[d];else if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=e.param!==undefined?e.param:!0:delete b[d]}}),a.each(b,function(d,e){b[d]=a.isFunction(e)?e(c):e}),a.each(["minlength","maxlength","min","max"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){b[this]&&(b[this]=[Number(b[this][0]),Number(b[this][1])])}),a.validator.autoCreateRanges&&(b.min&&b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),b.minlength&&b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b.messages&&delete b.messages;return b},normalizeRule:function(b){if(typeof b=="string"){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=d!==undefined?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";if(c.nodeName.toLowerCase()==="select"){var e=a(c).val();return e&&e.length>0}if(this.checkable(c))return this.getLength(b,c)>0;return a.trim(b).length>0},remote:function(b,c,d){if(this.optional(c))return"dependency-mismatch";var e=this.previousValue(c);this.settings.messages[c.name]||(this.settings.messages[c.name]={}),e.originalMessage=this.settings.messages[c.name].remote,this.settings.messages[c.name].remote=e.message,d=typeof d=="string"&&{url:d}||d;if(this.pending[c.name])return"pending";if(e.old===b)return e.valid;e.old=b;var f=this;this.startRequest(c);var g={};g[c.name]=b,a.ajax(a.extend(!0,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:g,success:function(d){f.settings.messages[c.name].remote=e.originalMessage;var g=d===!0;if(g){var h=f.formSubmitted;f.prepareElement(c),f.formSubmitted=h,f.successList.push(c),f.showErrors()}else{var i={},j=d||f.defaultMessage(c,"remote");i[c.name]=e.message=a.isFunction(j)?j(b):j,f.showErrors(i)}e.valid=g,f.stopRequest(c,g)}},d));return"pending"},minlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e>=d},maxlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e<=d},rangelength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||a<=c},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test
(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 \-]+/.test(a))return!1;var c=0,d=0,e=!1;a=a.replace(/\D/g,"");for(var f=a.length-1;f>=0;f--){var g=a.charAt(f);d=parseInt(g,10),e&&(d*=2)>9&&(d-=9),c+=d,e=!e}return c%10===0},accept:function(a,b,c){c=typeof c=="string"?c.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||a.match(new RegExp(".("+c+")$","i"))},equalTo:function(b,c,d){var e=a(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()});return b===e.val()}}}),a.format=a.validator.format}(jQuery),function(a){var b={};if(a.ajaxPrefilter)a.ajaxPrefilter(function(a,c,d){var e=a.port;a.mode==="abort"&&(b[e]&&b[e].abort(),b[e]=d)});else{var c=a.ajax;a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;if(e==="abort"){b[f]&&b[f].abort();return b[f]=c.apply(this,arguments)}return c.apply(this,arguments)}}}(jQuery),function(a){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&a.each({focus:"focusin",blur:"focusout"},function(b,c){function d(b){b=a.event.fix(b),b.type=c;return a.event.handle.call(this,b)}a.event.special[c]={setup:function(){this.addEventListener(b,d,!0)},teardown:function(){this.removeEventListener(b,d,!0)},handler:function(b){var d=arguments;d[0]=a.event.fix(b),d[0].type=c;return a.event.handle.apply(this,d)}}}),a.extend(a.fn,{validateDelegate:function(b,c,d){return this.bind(c,function(c){var e=a(c.target);if(e.is(b))return d.apply(e,arguments)})}})}(jQuery),function($){function checkRepetition(a,b){res="";for(var c=0;c<b.length;c++){repeated=!0;for(var d=0;d<a&&d+c+a<b.length;d++)repeated=repeated&&b.charAt(d+c)==b.charAt(d+c+a);d<a&&(repeated=!1),repeated?(c+=a-1,repeated=!1):res+=b.charAt(c)}return res}$.fn.passwordStrength=function(a){score=0,password=$(this).val();if(password.length<4)return 0;if(password.toLowerCase()==a.toLowerCase())return 0;score+=password.length*4,score+=(checkRepetition(1,password).length-password.length)*1,score+=(checkRepetition(2,password).length-password.length)*1,score+=(checkRepetition(3,password).length-password.length)*1,score+=(checkRepetition(4,password).length-password.length)*1,password.match(/(.*[0-9].*[0-9].*[0-9])/)&&(score+=5),password.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(score+=5),password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(score+=10),password.match(/([a-zA-Z])/)&&password.match(/([0-9])/)&&(score+=15),password.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&password.match(/([0-9])/)&&(score+=15),password.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&password.match(/([a-zA-Z])/)&&(score+=15);if(password.match(/^\w+$/)||password.match(/^\d+$/))score-=10;return score},$.fn.gform=function(config){var config=this.config=$.extend({ajaxmode:!0,onprepare:null,data:{__t:Math.random(),__data:"json"}},config||{}),me=this,form=$(this),eMsg=$(this).find("#error-message");eMsg.length>0&&eMsg.bind("click",function(){$(this).slideUp()}),$.isFunction(config.onprepare)&&config.onprepare.apply(form),form.find('[data-input="date"]').each(function(){var a=$.extend({changeYear:!0,dateFormat:me.config.dateFormat||(cgaf.getConfig("locale")==="id"?"dd/mm/yy":"mm/dd/yy"),regional:cgaf.getConfig("locale"),showOn:"button",defaultDate:null,buttonImage:"/assets/images/calendar_down.png"},me.config.dateconfig||{});$(this).attr("minyear")!==undefined&&(config.minDate=new Date(parseInt($(this).attr("minyear")),1,1)),$(this).datepicker(a)}),form.find('[data-input="autocomplete"]').each(function(){$this=$(this),$this.autocomplete({minLength:2,source:function(a,b){var c=a.term;$this.cache&&c in $this.cache?b($this.cache[c]):lastXhr=$.getJSON($this.attr("srclookup"),a,function(a,d,e){$this.cache=$this.cache||{},$this.cache[c]=a,e===lastXhr&&b(a)})}})}),form.find('[data-input="datetime"]').each(function(){$(this).timepicker()}),form.find('[data-input="daterange"]').each(function(){$(this).attr("data-time")?$(this).datetimepicker({timeOnly:!1,timeFormat:"hh:mm:ss",dateFormat:cgaf.getConfig("dateInputFormat")}):$(this).datepicker({dateFormat:cgaf.getConfig("dateInputFormat")})});var jax=form.attr("useajax")===undefined?config.ajaxmode:form.attr("useajax"),ajaxm=config.ajaxmode||typeof jax=="undefined"||jax==!0,validconfig=$.extend({debug:!0,submitHandler:function(frm,e){if(!ajaxm){frm.submit();return!1}e.preventDefault();var ajaxconfig=$.extend({dataType:"json",success:function(a,b,c){if(typeof a=="undefined"||a==null){$.showErrorMessage("Error  while processing request",$(form));return!1}if(!a._result)for(k in a){var d=$(form).find("#"+k);d.length>0&&d.val(a[k])}else a._redirect?location.href=a._redirect:a.content&&$.fancybox({content:a.content});a.message&&$.showErrorMessage(a.message);return!1},error:function(XMLHttpRequest,textStatus,errorThrown){if(textStatus==="parsererror"){try{var json=eval("("+XMLHttpRequest.responseText+")")}catch(e){$.showErrorMessage("Invalid JSON Data <br/>"+XMLHttpRequest.responseText);return!1}return this.success(json)}return!1}},config);form.ajaxSubmit(ajaxconfig);return!1}},config||{});$(this).validate(validconfig);return!1}}(jQuery),function(a){function d(){var a=[];return{Event:function(a,b,c){var d=!1;this.EventName=a,this.Source=b,this.args=c,this.stopPropagation=function(){d=!0},this.propagationStoped=function(){return d}},bind:function(b,c){a.push({name:b,callback:c})},trigger:function(b,c){for(var d in a){var e=a[d];e.name===b&&e.callback(c)}},unbind:function(b,c){for(var d in a){var e=a[d];try{if(e.name===b&&e.callback==c){a.splice(d,1);break}}catch(d){console.log(d)}}}}}function c(){var b=[],c=[];this._started=!1;return{onFinish:function(a){b.push(a),this._started=!1},add:function(a){c.push(a)},next:function(){c.length===0?a(b).each(function(){this.call()}):(this._started=!0,callback=c.shift(),callback.call(this))},start:function(){this.next()}}}function b(){if(!!a.fn.ajaxSubmit.debug){var b="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.windpostError&&window.opera.postError(b)}}window.log=b,a.openOverlay=function(b){typeof b=="string"&&(b={url:b});var c=a("#cgaf-modal"),b=a.extend(b,b||{title:"test",backdrop:!0,show:!1});c.length==0&&(c=a('<div id="cgaf-modal" class="modal fade in"/>').appendTo("body"),a('<div class="modal-header"><a class="icon-remove close" data-dismiss="modal"></a><h3></h3></div><div class="modal-body"></div> <div class="modal-footer"></div>').appendTo(c));var d=c.find(".modal-body").empty(),e=new a.fn.modal.Constructor(c,b);b.title=b.title||"&nbsp;",c.find(".modal-header h3").html(b.title);if(b.url){d.addClass("loading");var f=cgaf.url(b.url,{__uimode:"dialog"}).toString();d.load(f,function(a,c,f){b.callback&&b.callback.call(e,d),d.removeClass("loading")})}else if(b.contents){var g=b.contents;if(typeof g=="object"){var h="<ul>";for(var i in g)if(typeof g[i]=="string")h+="<li>"+g[i]+"</li>";else if(typeof g[i]=="object")for(var j in g[i])h+="<li>",h+=g[i][j],h+="</li>";h+="</ul>",g=h}d.html(g)}e.show()},a.showErrorMessage=function(b){a.openOverlay({title:"Error",contents:b})},a.fn.openOverlay=a.openOverlay,a.filterProperties=function(a,b){var c={};for(var d in a){var e=b[d];typeof e!="undefined"&&e!==null&&(c[d]=e)}return c};var e=function(){function l(a){if(window.cgaf)return window.cgaf;return new l.fn.init(a)}var b=[],e=new c,f={},g=!1,h={"jquery.mousewheel":""},i={},j=new d,k={};l.fn=l.prototype={defaults:{ismobile:!1},init:function(b){var c=this;f=a.extend(this.defaults,b||{});var d=a("#loading");d.length===0&&(d=a('<div id="loading" class="loading"><span>loading...</span></div>').appendTo("body").hide()),d.bind("ajaxSend",function(){a(this).show()}).bind("ajaxComplete",function(){c.defaultUIHandler(),a(this).hide()}),this.Events={CGAF_READY:"cgaf-ready",STATUS_CHANGED:"status-changed"}},getModuleInfo:function(a){typeof a=="object"&&(a=a._m);for(var b in k){var c=k[b];if(isNaN(a)){if(c.mod_dir.toLowerCase()==a.toLowerCase())return c}else if(b.toString().toLowerCase()==a.toString().toLowerCase())return c}},getJSAsync:function(a,b){var c=null;typeof a=="string"&&(a=[a]),typeof b=="function"&&(c=b);var d=function(a,b){var c=document.createElement("script");c.src=a,c.onload=c.onreadystatechange=function(){c.onreadystatechange=c.onload=null,b()};var d=document.getElementsByTagName("head")[0];(d||document.body).appendChild(c)};(function(){a.length!=0?d(a.shift(),arguments.callee):c&&c()})()},getJS:function(a,b,c){function g(){cgaf.log(arguments),d++}function f(a,c){d++==e&&typeof b!="undefined"&&b()}var d=1,e=typeof a!="string"?a.length:1;if(typeof a=="string")try{this.getJSAsync(a,f)}catch(h){g(h)}else if(typeof a=="object")for(var i in a){var j=a[i];if(typeof j!="string")continue;try{this.getJSAsync(a,f)}catch(h){g(h)}}else cgaf.log(typeof a)},ui:{},rescheduleQueue:function(){if(!g){if(b.length==0)return;g=!0;var a=b.shift(),c=a.data.callback||function(){},d=this;a.data.callback=function(){try{c.apply(this,arguments)}catch(a){}g=!1,d.rescheduleQueue()},a.callback.call(this,a.data)}},isJQPluginLoaded:function(a){return h.hasOwnProperty(a)},loadStyleSheet:function(b){Object.keys(i).length==0&&a("head > link").each(function(b,c){var d=a(c).attr("href");i[d]=!0});i.hasOwnProperty(b)||(i[b]=!0,console.log(b),a("head").append(a('<link rel="stylesheet" type="text/css" />').attr("href",b)))},isURL:function(a){var b=new RegExp("^(http|https|ftp)://([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&amp;%$-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9-]+.)*[a-zA-Z0-9-]+.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(/($|[a-zA-Z0-9.,?'\\+&amp;%$#=~_-]+))*$");return b.test(a)},loadJQPlugin:function(b,c){if(typeof b=="object"){var d=this;e.onFinish(c),a.each(b,function(a,b){e.add(function(){d.loadJQPlugin(b,function(){e.next()})})}),e.start()}else{if(this.isJQPluginLoaded(b)){this.trigger("onpluginloaded",b),a.isFunction(c)&&c.call(this);return}version=this.getConfig("jq.version","latest");var f=this.getConfig("jqurl",this.getConfig("asseturl",""))+"js/jQuery/plugins/"+b+".js";h[b]=f,this.require(f,c)}},require:function(a,b){this.getJS(a,function(){typeof b!="undefined"&&b.call(this,arguments)})},getJSON:function(b,c,d,e){var f=this;c=a.extend({__data:"json"},c||{});return jQuery.get(b,c,function(a){var b;try{b=(new Function("return "+a))()}catch(c){e?e.call(this,c,a):(cgaf.log(c.toString()+":"+a),f.showError("Invalid JSON Data<br/>"+a));return!1}d&&d.call(this,b)},"text")},getJSONApp:function(a,b){var c=cgaf.getConfig("appurl");return jQuery.get(c,a,function(a){typeof b!="undefined"&&b.call(this,(new Function("return "+a))())},"text")},ErrorType:{Notice:"error-type-notice",Warning:"error-type-warning",Error:"error-type-error"},defaultUIHandler:function(){a("#sysmessage").attr("handled")||a("#sysmessage").bind("click",function(){a(this).hide()}).attr("handled",!0),a("a[rel=__overlay]").each(function(){a(this).attr("__overlay")||(a(this).attr("__overlay",1),a(this).click(function(b){b.preventDefault(),a.openOverlay(a(this).attr("href"))}))}),a("a[data-target]").each(function(){var b=a(this).attr("href");b&&(b.substring(0,window.location.protocol.length)==window.location.protocol||b[0]==="/")&&a(a(this).attr("data-target")).length>0&&(a(this).data("data-target")||a(this).click(function(b){b.preventDefault(),a(a(this).attr("data-target")).load(a(this).attr("href"))}),a(this).data("data-target",!0))}),a("a[rel=__confirm]").each(function(){a(this).attr("__confirm")||(a(this).attr("__confirm",1),a(this).click(function(b){b.preventDefault();var c=a(this).attr("ctitle");c||(c=a(this).attr("title"));var d=a(this);cgaf.confirm(c,function(){var b=a.url(d.attr("href"));b.param("__confirm",1),a.openOverlay(b.toString())})}))})},setReady:function(){this.defaultUIHandler(),this.trigger(this.Events.CGAF_READY)},trigger:function(){j.trigger.apply(this,arguments)},bind:function(){j.bind.apply(this,arguments)},Windows:function(){return{open:function(b){return a.openOverlay(b)}}},Plugins:function(){return{select:function(){}}},setStatus:function(a){cgaf.trigger(cgaf.Events.STATUS_CHANGED,a)},setConfig:function(b,c){if(typeof c=="undefined"){var d=this;a.each(b,function(a,b){d.setConfig(a,b)})}else f[b]=c},confirm:function(b,c){var d=a("#confirm-dialog");d.length===0&&(d=a('<div id="confirm-dialog"></div>').appendTo("body")),d.html(b),d.dialog({modal:!0,buttons:{Confirm:function(){c&&c.call(this),a(this).dialog("close")},Cancel:function(){a(this).dialog("close")}}}),d.dialog("open")},dateFromISO:function(a,b){a=new Date(a);return a.format(b)},showError:function(b){a.showErrorMessage(b)},getConfig:function(a,b){return typeof f[a]=="undefined"?b:f[a]},log:function(a,b){window.log(arguments)},url:function(b,c){var d=new a.url(b);d.setParam(c);return d},Queue:function(a,c,d){b.push({id:a,data:d,callback:c}),this.rescheduleQueue()},toJSON:function(b){if(typeof b=="string")try{return(new Function("return "+b))()}catch(c){return null}cgaf.log(a(this));return b},Socket:function(){}},l.fn.init.prototype=l.fn;return l}();window.cgaf=new e}(jQuery),function(a){var b=function(){};b.prototype={defaults:{floatMode:!0,appId:null},init:function(b){if(!this.initialize){this.configs=a.extend(this.defaults,b||{}),this.configs.appId||(this.configs.appId=cgaf.getConfig("appid")),this.initialize=!0,this.online=null;var c=this.container=a("#chat-container");c.length===0&&(c=this.container=a('<div id="chat-container" class="chat-container'+(this.configs.floatMode?" float":"")+'">'+'    <div class="chat-message-container">'+'      <div class="message">'+"      </div>"+'      <div class="chat-message-action">'+'        <input type="text" id="msg">'+'        <button class="btn" type="button" id="send">Go!</button>'+"      </div>"+"    </div>"+'    <div class="chat-contacts">'+'      <div class="header">'+'        <label class="label label-status label-important ">Offline</label>'+'        <div class="btn-group">'+'          <button class="btn btn-log"><i class="icon icon-list-alt"></i></button>'+'          <button class="btn btn-refresh"><i class="icon icon-refresh"></i></button>'+"        </div>"+"      </div>"+'      <ul class="contact-list"></ul>'+"    </div>"+'    <div class="chat-log"></div>'+"</div>").appendTo(this.configs.floatMode?"body":"#wrapper")),this.configs.floatMode&&c.hide();var d=c.find(".label-status"),e=c.find("#connect"),f=c.find("#disconnect"),g=c.find("#send"),h=c.find("#msg"),i=c.find(".message"),j=this;this.setOnline(!1),WebPush.log=function(a){j.log(a,"LOG : ")};var k=this.server=new WebPush("ws://localhost:8088/");this.$log=c.find(".chat-log"),this.$contactList=c.find(".contact-list"),g.addClass("disabled"),c.find(".btn-refresh").click(a.proxy(this,"refreshContactList")),k.bind("open",function(){j.setOnline(!0),j.refreshContactList()}),c.find(".btn-log").click(function(b){b.preventDefault();var c=j.container.find(".chat-log");c.toggle(),c.is(":visible")?a(this).addClass("active"):a(this).removeClass("active")}),k.bind("connection_disconnected",function(){j.setOnline(!1)}),k.bind("close",function(){j.setOnline(!1)}),k.bind("connection_failed",function(){j.setOnline(!1)}),k.bind("message",function(b){var c=JSON.parse(b);j.log(b,"&lt;");var d=new Date;switch(c.service){case"chat":switch(c.action){case"userinfo":break;case"contact_list":j.refreshContactList(c.data,!0);break;case"error":j.log(c.message,"ERROR");break;default:i.append('<div><span class="label label-info t">'+d.toLocaleTimeString()+"</span>"+'<a class="from" target="__dialog" href="'+c.from+'"><span>'+c.from+"</span></a>"+'<span class="m">'+c.data+"</div></div>").find(".from").click(function(b){b.preventDefault(),j.send({action:"userinfo",userid:a(this).attr("href")})})}}}),f.click(function(a){a.preventDefault(),k.disconnect()}),e.click(function(a){a.preventDefault(),k.connect()}),d.click(function(){j.online?j.server.disconnect():j.server.connect()}),g.click(function(){if(!!j.online){var a=new Date;i.append('<div><span class="label label-important s">'+a.toLocaleTimeString()+'</span><span class="m">'+h.val()+"</div></div>"),j.send({action:"message",data:h.val()}),h.val("")}}),a(window).resize(a.proxy(this,"resetui")),this.resetui()}},refreshContactList:function(b,c){if(b&&c){this.$contactList.empty();for(var d in b)a("<li>"+b[d].id+"</li>").appendTo(this.$contactList)}else this.send({service:"chat",action:"contact_list"})},log:function(a,b){b=b||"&gt;",this.container.find(".chat-log").append("<div>"+b+":"+JSON.stringify(a)+"</div>")},send:function(a){a.appId||(a.appId=this.configs.appId),a.service||(a.service="chat"),this.log(a,"&gt;&nbsp;"),this.server.send(JSON.stringify(a))},setOnline:function(a){if(this.online!==a){this.online=a;var b=this.container.find(".label-status"),c=this.container.find("#send"),d=this.container.find("#msg");a?(this.container.find(".btn-refresh").removeClass("disabled"),d.attr("disabled",!1),b.removeClass("label-important").addClass("label-success").html("Online"),d.removeClass("disabled"),c.removeClass("disabled")):(d.attr("disabled","disabled"),this.container.find(".btn-refresh").addClass("disabled"),c.addClass("disabled"),b.removeClass("label-success").addClass("label-important").html("Offline"))}},resetui:function(){if(this.container&&this.container.is(":visible")){this.configs.floatMode||(this.container.closest("body").closest("html").css({overflow:"hidden"}),this.container.parent().css({padding:0}));var b=this.container.offset();this.container.css({height:(this.configs.floatMode?a(window).height()-b.top*2:a(window).height()-(40+b.top))+"px",left:(a(window).width()-this.container.width())/2+"px"})}},showMenu:function(a){this.configs.floatMode&&this.container.toggle(),this.resetui()}},a.chat=new b}(jQuery);var qq=qq||{};qq.extend=function(a,b){for(var c in b)a[c]=b[c]},qq.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);c=c||0;var d=a.length;c<0&&(c+=d);for(;c<d;c++)if(c in a&&a[c]===b)return c;return-1},qq.getUniqueId=function(){var a=0;return function(){return a++}}(),qq.attach=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},qq.detach=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c)},qq.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},qq.insertBefore=function(a,b){b.parentNode.insertBefore(a,b)},qq.remove=function(a){a.parentNode.removeChild(a)},qq.contains=function(a,b){if(a==b)return!0;return a.contains?a.contains(b):!!(b.compareDocumentPosition(a)&8)},qq.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;var c=a.firstChild;a.removeChild(c);return c}}(),qq.css=function(a,b){b.opacity!=null&&typeof a.style.opacity!="string"&&typeof a.filters!="undefined"&&(b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"),qq.extend(a.style,b)},qq.hasClass=function(a,b){var c=new RegExp("(^| )"+b+"( |$)");return c.test(a.className)},qq.addClass=function(a,b){qq.hasClass(a,b)||(a.className+=" "+b)},qq.removeClass=function(a,b){var c=new RegExp("(^| )"+b+"( |$)");a.className=a.className.replace(c," ").replace(/^\s+|\s+$/g,"")},qq.setText=function(a,b){a.innerText=b,a.textContent=b},qq.children=function(a){var b=[],c=a.firstChild;while(c)c.nodeType==1&&b.push(c),c=c.nextSibling;return b},qq.getByClass=function(a,b){if(a.querySelectorAll)return a.querySelectorAll("."+b);var c=[],d=a.getElementsByTagName("*"),e=d.length;for(var f=0;f<e;f++)qq.hasClass(d[f],b)&&c.push(d[f]);return c},qq.obj2url=function(a,b,c){var d=[],e="&",f=function(a,c){var e=b?/\[\]$/.test(b)?b:b+"["+c+"]":c;e!="undefined"&&c!="undefined"&&d.push(typeof a=="object"?qq.obj2url(a,e,!0):Object.prototype.toString.call(a)==="[object Function]"?encodeURIComponent(e)+"="+encodeURIComponent(a()):encodeURIComponent(e)+"="+encodeURIComponent(a))};if(!c&&b)e=/\?/.test(b)?/\?$/.test(b)?"":"&":"?",d.push(b),d.push(qq.obj2url(a));else if(Object.prototype.toString.call(a)==="[object Array]"&&typeof a!="undefined")for(var g=0,h=a.length;g<h;++g)f(a[g],g);else if(typeof a!="undefined"&&a!==null&&typeof a=="object")for(var g in a)f(a[g],g);else d.push(encodeURIComponent(b)+"="+encodeURIComponent(a));return d.join(e).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(a){this._options={debug:!1,action:"/server/upload",params:{},button:null,multiple:!0,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(a,b){},onProgress:function(a,b,c,d){},onComplete:function(a,b,c){},onCancel:function(a,b){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(a){alert(a)}},qq.extend(this._options,a),this._filesInProgress=0,this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FileUploaderBasic.prototype={setParams:function(a){this._options.params=a},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(a){var b=this;return new qq.UploadButton({element:a,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(a){b._onInputChange(a)}})},_createUploadHandler:function(){var a=this,b;qq.UploadHandlerXhr.isSupported()?b="UploadHandlerXhr":b="UploadHandlerForm";var c=new qq[b]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(b,c,d,e){a._onProgress(b,c,d,e),a._options.onProgress(b,c,d,e)},onComplete:function(b,c,d){a._onComplete(b,c,d),a._options.onComplete(b,c,d)},onCancel:function(b,c){a._onCancel(b,c),a._options.onCancel(b,c)}});return c},_preventLeaveInProgress:function(){var a=this;qq.attach(window,"beforeunload",function(b){if(!!a._filesInProgress){var b=b||window.event;b.returnValue=a._options.messages.onLeave;return a._options.messages.onLeave}})},_onSubmit:function(a,b){this._filesInProgress++},_onProgress:function(a,b,c,d){},_onComplete:function(a,b,c){this._filesInProgress--,c.error&&this._options.showMessage(c.error)},_onCancel:function(a,b){this._filesInProgress--},_onInputChange:function(a){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(a.files):this._validateFile(a)&&this._uploadFile(a),this._button.reset()},_uploadFileList:function(a){for(var b=0;b<a.length;b++)if(!this._validateFile(a[b]))return;for(var b=0;b<a.length;b++)this._uploadFile(a[b])},_uploadFile:function(a){var b=this._handler.add(a),c=this._handler.getName(b);this._options.onSubmit(b,c)!==!1&&(this._onSubmit(b,c),this._handler.upload(b,this._options.params))},_validateFile:function(a){var b,c;a.value?b=a.value.replace(/.*(\/|\\)/,""):(b=a.fileName!=null?a.fileName:a.name,c=a.fileSize!=null?a.fileSize:a.size);if(!this._isAllowedExtension(b)){this._error("typeError",b);return!1}if(c===0){this._error("emptyError",b);return!1}if(c&&this._options.sizeLimit&&c>this._options.sizeLimit){this._error("sizeError",b);return!1}if(c&&c<this._options.minSizeLimit){this._error("minSizeError",b);return!1}return!0},_error:function(a,b){function d(a,b){c=c.replace(a,b)}var c=this._options.messages[a];d("{file}",this._formatFileName(b)),d("{extensions}",this._options.allowedExtensions.join(", ")),d("{sizeLimit}",this._formatSize(this._options.sizeLimit)),d("{minSizeLimit}",this._formatSize(this._options.minSizeLimit)),this._options.showMessage(c)},_formatFileName:function(a){a.length>33&&(a=a.slice(0,19)+"..."+a.slice(-13));return a},_isAllowedExtension:function(a){var b=-1!==a.indexOf(".")?a.replace(/.*[.]/,"").toLowerCase():"",c=this._options.allowedExtensions;if(!c.length)return!0;for(var d=0;d<c.length;d++)if(c[d].toLowerCase()==b)return!0;return!1},_formatSize:function(a){var b=-1;do a=a/1024,b++;while(a>99);return Math.max(a,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]}},qq.FileUploader=function(a){qq.FileUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Upload a file</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">Cancel</a><span class="qq-upload-failed-text">Failed</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}}),qq.extend(this._options,a),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button=this._createUploadButton(this._find(this._element,"button")),this._bindCancelEvent(),this._setupDragDrop()},qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype),qq.extend(qq.FileUploader.prototype,{_find:function(a,b){var c=qq.getByClass(a,this._options.classes[b])[0];if(!c)throw new Error("element not found "+b);return c},_setupDragDrop:function(){var a=this,b=this._find(this._element,"drop"),c=new qq.UploadDropZone({element:b,onEnter:function(c){qq.addClass(b,a._classes.dropActive),c.stopPropagation()},onLeave:function(a){a.stopPropagation()},onLeaveNotDescendants:function(c){qq.removeClass(b,a._classes.dropActive)},onDrop:function(c){b.style.display="none",qq.removeClass(b,a._classes.dropActive),a._uploadFileList(c.dataTransfer.files)}});b.style.display="none",qq.attach(document,"dragenter",function(a){!c._isValidFileDrag(a)||(b.style.display="block")}),qq.attach(document,"dragleave",function(a){if(!!c._isValidFileDrag(a)){var d=document.elementFromPoint(a.clientX,a.clientY);if(!d||d.nodeName=="HTML")b.style.display="none"}})},_onSubmit:function(a,b){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(a,b)},_onProgress:function(a,b,c,d){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var e=this._getItemByFileId(a),f=this._find(e,"size");f.style.display="inline";var g;c!=d?g=Math.round(c/d*100)+"% from "+this._formatSize(d):g=this._formatSize(d),qq.setText(f,g)},_onComplete:function(a,b,c){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var d=this._getItemByFileId(a);qq.remove(this._find(d,"cancel")),qq.remove(this._find(d,"spinner")),c.success?qq.addClass(d,this._classes.success):qq.addClass(d,this._classes.fail)},_addToList:function(a,b){var c=qq.toElement(this._options.fileTemplate);c.qqFileId=a;var d=this._find(c,"file");qq.setText(d,this._formatFileName(b)),this._find(c,"size").style.display="none",this._listElement.appendChild(c)},_getItemByFileId:function(a){var b=this._listElement.firstChild;while(b){if(b.qqFileId==a)return b;b=b.nextSibling}},_bindCancelEvent:function(){var a=this,b=this._listElement;qq.attach(b,"click",function(b){b=b||window.event;var c=b.target||b.srcElement;if(qq.hasClass(c,a._classes.cancel)){qq.preventDefault(b);var d=c.parentNode;a._handler.cancel(d.qqFileId),qq.remove(d)}})}}),qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(a){},onLeave:function(a){},onLeaveNotDescendants:function(a){},onDrop:function(a){}},qq.extend(this._options,a),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_disableDropOutside:function(a){qq.UploadDropZone.dropOutsideDisabled||(qq.attach(document,"dragover",function(a){a.dataTransfer&&(a.dataTransfer.dropEffect="none",a.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var a=this;qq.attach(a._element,"dragover",function(b){if(!!a._isValidFileDrag(b)){var c=b.dataTransfer.effectAllowed;c=="move"||c=="linkMove"?b.dataTransfer.dropEffect="move":b.dataTransfer.dropEffect="copy",b.stopPropagation(),b.preventDefault()}}),qq.attach(a._element,"dragenter",function(b){!a._isValidFileDrag(b)||a._options.onEnter(b)}),qq.attach(a._element,"dragleave",function(b){if(!!a._isValidFileDrag(b)){a._options.onLeave(b);var c=document.elementFromPoint(b.clientX,b.clientY);if(qq.contains(this,c))return;a._options.onLeaveNotDescendants(b)}}),qq.attach(a._element,"drop",function(b){!a._isValidFileDrag(b)||(b.preventDefault(),a._options.onDrop(b))})},_isValidFileDrag:function(a){var b=a.dataTransfer,c=navigator.userAgent.indexOf("AppleWebKit")>-1;return b&&b.effectAllowed!="none"&&(b.files||!c&&b.types.contains&&b.types.contains("Files"))}},qq.UploadButton=function(a){this._options={element:null,multiple:!1,name:"file",onChange:function(a){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,a),this._element=this._options.element,qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq.remove(this._input),qq.removeClass(this._element,this._options.focusClass),this._input=this._createInput()},_createInput:function(){var a=document.createElement("input");this._options.multiple&&a.setAttribute("multiple","multiple"),a.setAttribute("type","file"),a.setAttribute("name",this._options.name),qq.css(a,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(a);var b=this;qq.attach(a,"change",function(){b._options.onChange(a)}),qq.attach(a,"mouseover",function(){qq.addClass(b._element,b._options.hoverClass)}),qq.attach(a,"mouseout",function(){qq.removeClass(b._element,b._options.hoverClass)}),qq.attach(a,"focus",function(){qq.addClass(b._element,b._options.focusClass)}),qq.attach(a,"blur",function(){qq.removeClass(b._element,b._options.focusClass)}),window.attachEvent&&a.setAttribute("tabIndex","-1");return a}},qq.UploadHandlerAbstract=function(a){this._options={debug:!1,action:"/upload.php",maxConnections:999,onProgress:function(a,b,c,d){},onComplete:function(a,b,c){},onCancel:function(a,b){}},qq.extend(this._options,a),this._queue=[],this._params=[]},qq.UploadHandlerAbstract.prototype={log:function(a){this._options.debug&&window.console&&console.log("[uploader] "+a)},add:function(a){},upload:function(a,b){var c=this._queue.push(a),d={};qq.extend(d,b),this._params[a]=d,c<=this._options.maxConnections&&this._upload(a,this._params[a])},cancel:function(a){this._cancel(a),this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++)this._cancel(this._queue[a]);this._queue=[]},getName:function(a){},getSize:function(a){},getQueue:function(){return this._queue},_upload:function(a){},_cancel:function(a){},_dequeue:function(a){var b=qq.indexOf(this._queue,a);this._queue.splice(b,1);var c=this._options.maxConnections;if(this._queue.length>=c&&b<c){var d=this._queue[c-1];this._upload(d,this._params[d])}}},qq.UploadHandlerForm=function(a){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name","qqfile");var b="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[b]=a,a.parentNode&&qq.remove(a);return b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},_cancel:function(a){this._options.onCancel(a,this.getName(a)),delete this._inputs[a];var b=document.getElementById(a);b&&(b.setAttribute("src","javascript:false;"),qq.remove(b))},_upload:function(a,b){var c=this._inputs[a];if(!c)throw new Error("file with passed id was not added, or already uploaded or cancelled");var d=this.getName(a),e=this._createIframe(a),f=this._createForm(e,b);f.appendChild(c);var g=this;this._attachLoadEvent
(e,function(){g.log("iframe loaded");var b=g._getIframeContentJSON(e);g._options.onComplete(a,d,b),g._dequeue(a),delete g._inputs[a],setTimeout(function(){qq.remove(e)},1)}),f.submit(),qq.remove(f);return a},_attachLoadEvent:function(a,b){qq.attach(a,"load",function(){if(!!a.parentNode){if(a.contentDocument&&a.contentDocument.body&&a.contentDocument.body.innerHTML=="false")return;b()}})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+doc.body.innerHTML);try{response=eval("("+doc.body.innerHTML+")")}catch(err){response={}}return response},_createIframe:function(a){var b=qq.toElement('<iframe src="javascript:false;" name="'+a+'" />');b.setAttribute("id",a),b.style.display="none",document.body.appendChild(b);return b},_createForm:function(a,b){var c=qq.toElement('<form method="post" enctype="multipart/form-data"></form>'),d=qq.obj2url(b,this._options.action);c.setAttribute("action",d),c.setAttribute("target",a.name),c.style.display="none",document.body.appendChild(c);return c}}),qq.UploadHandlerXhr=function(a){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");a.type="file";return"multiple"in a&&typeof File!="undefined"&&typeof (new XMLHttpRequest).upload!="undefined"},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File))throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)");return this._files.push(a)-1},getName:function(a){var b=this._files[a];return b.fileName!=null?b.fileName:b.name},getSize:function(a){var b=this._files[a];return b.fileSize!=null?b.fileSize:b.size},getLoaded:function(a){return this._loaded[a]||0},_upload:function(a,b){var c=this._files[a],d=this.getName(a),e=this.getSize(a);this._loaded[a]=0;var f=this._xhrs[a]=new XMLHttpRequest,g=this;f.upload.onprogress=function(b){b.lengthComputable&&(g._loaded[a]=b.loaded,g._options.onProgress(a,d,b.loaded,b.total))},f.onreadystatechange=function(){f.readyState==4&&g._onComplete(a,f)},b=b||{},b.qqfile=d;var h=qq.obj2url(b,this._options.action);f.open("POST",h,!0),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.setRequestHeader("X-File-Name",encodeURIComponent(d)),f.setRequestHeader("Content-Type","application/octet-stream"),f.send(c)},_onComplete:function(id,xhr){if(!!this._files[id]){var name=this.getName(id),size=this.getSize(id);this._options.onProgress(id,name,size,size);if(xhr.status==200){this.log("xhr - server response received"),this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")")}catch(err){response={}}this._options.onComplete(id,name,response)}else this._options.onComplete(id,name,{});this._files[id]=null,this._xhrs[id]=null,this._dequeue(id)}},_cancel:function(a){this._options.onCancel(a,this.getName(a)),this._files[a]=null,this._xhrs[a]&&(this._xhrs[a].abort(),this._xhrs[a]=null)}}),function(){var a=function(){function c(a,b,c,d){function f(b){for(var c=0;c<b.length;c++)if(b[c].win===a)return!0;return!1}var g=!1;if(b==="*")for(var h in e){if(!e.hasOwnProperty(h))continue;if(h==="*")continue;if(typeof e[h][c]=="object"){g=f(e[h][c]);if(g)break}}else e["*"]&&e["*"][c]&&(g=f(e["*"][c])),!g&&e[b]&&e[b][c]&&(g=f(e[b][c]));if(g)throw"A channel is already bound to the same window which overlaps with origin '"+b+"' and has scope '"+c+"'";typeof e[b]!="object"&&(e[b]={}),typeof e[b][c]!="object"&&(e[b][c]=[]),e[b][c].push({win:a,handler:d})}function b(a,b,c){var d=e[b][c];for(var f=0;f<d.length;f++)d[f].win===a&&d.splice(f,1);e[b][c].length===0&&delete e[b][c]}function a(a){return Array.isArray?Array.isArray(a):a.constructor.toString().indexOf("Array")!=-1}"use strict";var d=Math.floor(Math.random()*1000001),e={},f={},g=function(a){try{var b=JSON.parse(a.data);if(typeof b!="object"||b===null)throw"malformed"}catch(a){return}var c=a.source,d=a.origin,g,h,i;if(typeof b.method=="string"){var j=b.method.split("::");j.length==2?(g=j[0],i=j[1]):i=b.method}typeof b.id!="undefined"&&(h=b.id);if(typeof i=="string"){var k=!1;if(e[d]&&e[d][g])for(var h=0;h<e[d][g].length;h++)if(e[d][g][h].win===c){e[d][g][h].handler(d,i,b),k=!0;break}if(!k&&e["*"]&&e["*"][g])for(var h=0;h<e["*"][g].length;h++)if(e["*"][g][h].win===c){e["*"][g][h].handler(d,i,b);break}}else typeof h!="undefined"&&f[h]&&f[h](d,i,b)};window.addEventListener?window.addEventListener("message",g,!1):window.attachEvent&&window.attachEvent("onmessage",g);return{build:function(e){var g=function(a){if(e.debugOutput&&window.console&&window.console.log){try{typeof a!="string"&&(a=JSON.stringify(a))}catch(b){}console.log("["+j+"] "+a)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if(typeof e!="object")throw"Channel build invoked without a proper object argument";if(!e.window||!e.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===e.window)throw"target window is same as present window -- not allowed";var h=!1;if(typeof e.origin=="string"){var i;e.origin==="*"?h=!0:null!==(i=e.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(e.origin=i[0].toLowerCase(),h=!0)}if(!h)throw"Channel.build() called with an invalid origin";if(typeof e.scope!="undefined"){if(typeof e.scope!="string")throw"scope, when specified, must be a string";if(e.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}var j=function(){var a="",b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}(),k={},l={},m={},n=!1,o=[],p=function(a,b,c){var d=!1,e=!1;return{origin:b,invoke:function(b,d){if(!m[a])throw"attempting to invoke a callback of a nonexistent transaction: "+a;var e=!1;for(var f=0;f<c.length;f++)if(b===c[f]){e=!0;break}if(!e)throw"request supports no such callback '"+b+"'";t({id:a,callback:b,params:d})},error:function(b,c){e=!0;if(!m[a])throw"error called for nonexistent message: "+a;delete m[a],t({id:a,error:b,message:c})},complete:function(b){e=!0;if(!m[a])throw"complete called for nonexistent message: "+a;delete m[a],t({id:a,result:b})},delayReturn:function(a){typeof a=="boolean"&&(d=a===!0);return d},completed:function(){return e}}},q=function(a,b,c){return window.setTimeout(function(){if(l[a]){var d="timeout ("+b+"ms) exceeded on method '"+c+"'";(1,l[a].error)("timeout_error",d),delete l[a],delete f[a]}},b)},r=function(b,c,d){if(typeof e.gotMessageObserver=="function")try{e.gotMessageObserver(b,d)}catch(h){g("gotMessageObserver() raised an exception: "+h.toString())}if(d.id&&c){if(k[c]){var i=p(d.id,b,d.callbacks?d.callbacks:[]);m[d.id]={};try{if(d.callbacks&&a(d.callbacks)&&d.callbacks.length>0)for(var j=0;j<d.callbacks.length;j++){var n=d.callbacks[j],o=d.params,q=n.split("/");for(var r=0;r<q.length-1;r++){var s=q[r];typeof o[s]!="object"&&(o[s]={}),o=o[s]}o[q[q.length-1]]=function(){var a=n;return function(b){return i.invoke(a,b)}}()}var t=k[c](i,d.params);!i.delayReturn()&&!i.completed()&&i.complete(t)}catch(h){var u="runtime_error",v=null;typeof h=="string"?v=h:typeof h=="object"&&(h&&a(h)&&h.length==2?(u=h[0],v=h[1]):typeof h.error=="string"&&(u=h.error,h.message?typeof h.message=="string"?v=h.message:h=h.message:v=""));if(v===null)try{v=JSON.stringify(h),typeof v=="undefined"&&(v=h.toString())}catch(w){v=h.toString()}i.error(u,v)}}}else d.id&&d.callback?!l[d.id]||!l[d.id].callbacks||!l[d.id].callbacks[d.callback]?g("ignoring invalid callback, id:"+d.id+" ("+d.callback+")"):l[d.id].callbacks[d.callback](d.params):d.id?l[d.id]?(d.error?(1,l[d.id].error)(d.error,d.message):d.result!==undefined?(1,l[d.id].success)(d.result):(1,l[d.id].success)(),delete l[d.id],delete f[d.id]):g("ignoring invalid response: "+d.id):c&&k[c]&&k[c](null,d.params)};c(e.window,e.origin,typeof e.scope=="string"?e.scope:"",r);var s=function(a){typeof e.scope=="string"&&e.scope.length&&(a=[e.scope,a].join("::"));return a},t=function(a,b){if(!a)throw"postMessage called with null message";var c=n?"post  ":"queue ";g(c+" message: "+JSON.stringify(a));if(!b&&!n)o.push(a);else{if(typeof e.postMessageObserver=="function")try{e.postMessageObserver(e.origin,a)}catch(d){g("postMessageObserver() raised an exception: "+d.toString())}e.window.postMessage(JSON.stringify(a),e.origin)}},u=function(a,b){g("ready msg received");if(n)throw"received ready message while in ready state.  help!";b==="ping"?j+="-R":j+="-L",v.unbind("__ready"),n=!0,g("ready msg accepted."),b==="ping"&&v.notify({method:"__ready",params:"pong"});while(o.length)t(o.pop());typeof e.onReady=="function"&&e.onReady(v)},v={unbind:function(a){if(k[a]){if(delete k[a])return!0;throw"can't delete method: "+a}return!1},bind:function(a,b){if(!a||typeof a!="string")throw"'method' argument to bind must be string";if(!b||typeof b!="function")throw"callback missing from bind params";if(k[a])throw"method '"+a+"' is already bound!";k[a]=b;return this},call:function(a){if(!a)throw"missing arguments to call function";if(!a.method||typeof a.method!="string")throw"'method' argument to call must be string";if(!a.success||typeof a.success!="function")throw"'success' callback missing from call";var b={},c=[],e=function(a,d){if(typeof d=="object")for(var f in d){if(!d.hasOwnProperty(f))continue;var g=a+(a.length?"/":"")+f;typeof d[f]=="function"?(b[g]=d[f],c.push(g),delete d[f]):typeof d[f]=="object"&&e(g,d[f])}};e("",a.params);var g={id:d,method:s(a.method),params:a.params};c.length&&(g.callbacks=c),a.timeout&&q(d,a.timeout,s(a.method)),l[d]={callbacks:b,error:a.error,success:a.success},f[d]=r,d++,t(g)},notify:function(a){if(!a)throw"missing arguments to notify function";if(!a.method||typeof a.method!="string")throw"'method' argument to notify must be string";t({method:s(a.method),params:a.params})},destroy:function(){b(e.window,e.origin,typeof e.scope=="string"?e.scope:""),window.removeEventListener?window.removeEventListener("message",r,!1):window.detachEvent&&window.detachEvent("onmessage",r),n=!1,k={},m={},l={},e.origin=null,o=[],g("channel destroyed"),j=""}};v.bind("__ready",u),setTimeout(function(){},0);return v}}}();WinChan=function(){function h(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function g(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener&&a.removeEventListener(b,c,!1)}function f(){var a=-1;if(navigator.appName=="Microsoft Internet Explorer"){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(b)!=null&&(a=parseFloat(RegExp.$1))}return a>=8}function e(){try{return d.indexOf("Fennec/")!=-1||d.indexOf("Firefox/")!=-1&&d.indexOf("Android")!=-1}catch(a){}return!1}function c(){return window.JSON&&window.JSON.stringify&&window.JSON.parse&&window.postMessage}function b(a){/^https?:\/\//.test(a)||(a=window.location.href);var b=/^(https?:\/\/[-_a-zA-Z\.0-9:]+)/.exec(a);return b?b[1]:a}function a(){var a=window.location,b=window.opener.frames,c=a.protocol+"//"+a.host;for(i=b.length-1;i>=0;i++)try{if(b[i].location.href.indexOf(c)===0&&b[i].name===j)return b[i]}catch(d){}return}var j="__winchan_relay_frame",k=f();return c()?{open:function(a,c){function f(){l&&document.body.removeChild(l),l=undefined,o&&o.close(),o=undefined}function d(a){try{var b=JSON.parse(a.data);b.a==="ready"?n.postMessage(p,m):b.a==="error"?c&&(c(b.d),c=null):b.a==="response"&&(g(window,"message",d),g(window,"unload",f),f(),c&&(c(null,b.d),c=null))}catch(a){}}if(!c)throw"missing required callback argument";var i;a.url||(i="missing required 'url' parameter"),a.relay_url||(i="missing required 'relay_url' parameter"),i&&setTimeout(function(){c(i)},0);if(!a.window_features||e())a.window_features=undefined;var l,m=b(a.url);if(m!==b(a.relay_url))return setTimeout(function(){c("invalid arguments: origin of url and relay_url must match")},0);var n;k&&(l=document.createElement("iframe"),l.setAttribute("src",a.relay_url),l.style.display="none",l.setAttribute("name",j),document.body.appendChild(l),n=l.contentWindow);var o=window.open(a.url,null,a.window_features);n||(n=o);var p=JSON.stringify({a:"request",d:a.params});h(window,"unload",f),h(window,"message",d);return{close:f,focus:function(){if(o)try{o.focus()}catch(a){}}}}}:{open:function(a,b,c,d){setTimeout(function(){d("unsupported browser")},0)}}}();var b=function(){function i(a,b){k=a,j=b}function h(){var a=-1;if(k.appName=="Microsoft Internet Explorer"){var b=k.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(b)!=null&&(a=parseFloat(RegExp.$1))}return a}function g(){var a=h(),b=a>-1&&a<8;if(b)return"BAD_IE_VERSION"}function f(){return g()}function e(){try{var a="localStorage"in j&&j.localStorage!==null;if(a)j.localStorage.setItem("test","true"),j.localStorage.removeItem("test");else return"LOCALSTORAGE_NOT_SUPPORTED"}catch(b){return"LOCALSTORAGE_DISABLED"}}function d(){if(!j.postMessage)return"POSTMESSAGE_NOT_SUPPORTED"}function c(){if(!(window.JSON&&window.JSON.stringify&&window.JSON.parse))return"JSON_NOT_SUPPORTED"}function b(){l=f()||e()||d()||c();return!l}function a(){return l}var j=window,k=navigator,l;return{setTestEnv:i,isSupported:b,getNoSupportReason:a}}();navigator.id||(navigator.id={});if(!navigator.id.request||navigator.id._shimmed){var c="https://browserid.org",d=navigator.userAgent,e=d.indexOf("Fennec/")!=-1||d.indexOf("Firefox/")!=-1&&d.indexOf("Android")!=-1,f=e?undefined:"menubar=0,location=1,resizable=1,scrollbars=1,status=0,dialog=1,width=700,height=375",g,h={login:null,logout:null,ready:null},j=undefined;function k(a){a!==!0;if(j===undefined)j=a;else if(j!=a)throw"you cannot combine the navigator.id.watch() API with navigator.id.getVerifiedEmail() or navigator.id.get()this site should instead use navigator.id.request() and navigator.id.watch()"}var l;function m(){try{if(!l){var b=window.document,d=b.createElement("iframe");d.style.display="none",b.body.appendChild(d),d.src=c+"/communication_iframe",l=a.build({window:d.contentWindow,origin:c,scope:"mozid_ni",onReady:function(){l.call({method:"loaded",success:function(){h.ready&&h.ready()},error:function(){}})}}),l.bind("logout",function(a,b){h.logout&&h.logout()}),l.bind("login",function(a,b){h.login&&h.login(b)})}}catch(e){l=undefined}}function n(a){if(typeof a=="object"){if(a.onlogin&&typeof a.onlogin!="function"||a.onlogout&&typeof a.onlogout!="function"||a.onready&&typeof a.onready!="function")throw"non-function where function expected in parameters to navigator.id.watch()";h.login=a.onlogin||null,h.logout=a.onlogout||null,h.ready=a.onready||null,m(),typeof a.email!="undefined"&&l&&l.notify({method:"loggedInUser",params:a.email})}}function o(a){if(g)try{g.focus()}catch(d){}else{if(!b.isSupported()){var e=b.getNoSupportReason(),i="unsupported_dialog";e==="LOCALSTORAGE_DISABLED"&&(i="cookies_disabled"),g=window.open(c+"/"+i,null,f);return}l&&l.notify({method:"dialog_running"}),g=WinChan.open({url:c+"/sign_in",relay_url:c+"/relay",window_features:f,params:{method:"get",params:a}},function(b,c){l&&(!b&&c&&c.email&&l.notify({method:"loggedInUser",params:c.email}),l.notify({method:"dialog_complete"})),g=undefined;if(!b&&c&&c.assertion)try{h.login&&h.login(c.assertion)}catch(d){}a&&a.onclose&&a.onclose(),delete a.onclose})}}navigator.id={experimental:{request:function(a){k(!1);return o(a)},watch:function(a){k(!1),n(a)}},logout:function(a){m(),l.notify({method:"logout"}),typeof a=="function"&&setTimeout(a,0)},get:function(a,b){b=b||{},k(!0),n({onlogin:function(b){a&&(a(b),a=null)}}),b.onclose=function(){a&&(a(null),a=null),n({})},b&&b.silent?a&&setTimeout(function(){a(null)},0):o(b)},getVerifiedEmail:function(a){k(!0),navigator.id.get(a)},_shimmed:!0}}}()