(function(){var a=function(){function c(a,b,c,d){function f(b){for(var c=0;c<b.length;c++)if(b[c].win===a)return!0;return!1}var g=!1;if(b==="*")for(var h in e){if(!e.hasOwnProperty(h))continue;if(h==="*")continue;if(typeof e[h][c]=="object"){g=f(e[h][c]);if(g)break}}else e["*"]&&e["*"][c]&&(g=f(e["*"][c])),!g&&e[b]&&e[b][c]&&(g=f(e[b][c]));if(g)throw"A channel is already bound to the same window which overlaps with origin '"+b+"' and has scope '"+c+"'";typeof e[b]!="object"&&(e[b]={}),typeof e[b][c]!="object"&&(e[b][c]=[]),e[b][c].push({win:a,handler:d})}function b(a,b,c){var d=e[b][c];for(var f=0;f<d.length;f++)d[f].win===a&&d.splice(f,1);e[b][c].length===0&&delete e[b][c]}function a(a){return Array.isArray?Array.isArray(a):a.constructor.toString().indexOf("Array")!=-1}"use strict";var d=Math.floor(Math.random()*1000001),e={},f={},g=function(a){try{var b=JSON.parse(a.data);if(typeof b!="object"||b===null)throw"malformed"}catch(a){return}var c=a.source,d=a.origin,g,h,i;if(typeof b.method=="string"){var j=b.method.split("::");j.length==2?(g=j[0],i=j[1]):i=b.method}typeof b.id!="undefined"&&(h=b.id);if(typeof i=="string"){var k=!1;if(e[d]&&e[d][g])for(var h=0;h<e[d][g].length;h++)if(e[d][g][h].win===c){e[d][g][h].handler(d,i,b),k=!0;break}if(!k&&e["*"]&&e["*"][g])for(var h=0;h<e["*"][g].length;h++)if(e["*"][g][h].win===c){e["*"][g][h].handler(d,i,b);break}}else typeof h!="undefined"&&f[h]&&f[h](d,i,b)};window.addEventListener?window.addEventListener("message",g,!1):window.attachEvent&&window.attachEvent("onmessage",g);return{build:function(e){var g=function(a){if(e.debugOutput&&window.console&&window.console.log){try{typeof a!="string"&&(a=JSON.stringify(a))}catch(b){}console.log("["+j+"] "+a)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if(typeof e!="object")throw"Channel build invoked without a proper object argument";if(!e.window||!e.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===e.window)throw"target window is same as present window -- not allowed";var h=!1;if(typeof e.origin=="string"){var i;e.origin==="*"?h=!0:null!==(i=e.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(e.origin=i[0].toLowerCase(),h=!0)}if(!h)throw"Channel.build() called with an invalid origin";if(typeof e.scope!="undefined"){if(typeof e.scope!="string")throw"scope, when specified, must be a string";if(e.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}var j=function(){var a="",b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}(),k={},l={},m={},n=!1,o=[],p=function(a,b,c){var d=!1,e=!1;return{origin:b,invoke:function(b,d){if(!m[a])throw"attempting to invoke a callback of a nonexistent transaction: "+a;var e=!1;for(var f=0;f<c.length;f++)if(b===c[f]){e=!0;break}if(!e)throw"request supports no such callback '"+b+"'";t({id:a,callback:b,params:d})},error:function(b,c){e=!0;if(!m[a])throw"error called for nonexistent message: "+a;delete m[a],t({id:a,error:b,message:c})},complete:function(b){e=!0;if(!m[a])throw"complete called for nonexistent message: "+a;delete m[a],t({id:a,result:b})},delayReturn:function(a){typeof a=="boolean"&&(d=a===!0);return d},completed:function(){return e}}},q=function(a,b,c){return window.setTimeout(function(){if(l[a]){var d="timeout ("+b+"ms) exceeded on method '"+c+"'";(1,l[a].error)("timeout_error",d),delete l[a],delete f[a]}},b)},r=function(b,c,d){if(typeof e.gotMessageObserver=="function")try{e.gotMessageObserver(b,d)}catch(h){g("gotMessageObserver() raised an exception: "+h.toString())}if(d.id&&c){if(k[c]){var i=p(d.id,b,d.callbacks?d.callbacks:[]);m[d.id]={};try{if(d.callbacks&&a(d.callbacks)&&d.callbacks.length>0)for(var j=0;j<d.callbacks.length;j++){var n=d.callbacks[j],o=d.params,q=n.split("/");for(var r=0;r<q.length-1;r++){var s=q[r];typeof o[s]!="object"&&(o[s]={}),o=o[s]}o[q[q.length-1]]=function(){var a=n;return function(b){return i.invoke(a,b)}}()}var t=k[c](i,d.params);!i.delayReturn()&&!i.completed()&&i.complete(t)}catch(h){var u="runtime_error",v=null;typeof h=="string"?v=h:typeof h=="object"&&(h&&a(h)&&h.length==2?(u=h[0],v=h[1]):typeof h.error=="string"&&(u=h.error,h.message?typeof h.message=="string"?v=h.message:h=h.message:v=""));if(v===null)try{v=JSON.stringify(h),typeof v=="undefined"&&(v=h.toString())}catch(w){v=h.toString()}i.error(u,v)}}}else d.id&&d.callback?!l[d.id]||!l[d.id].callbacks||!l[d.id].callbacks[d.callback]?g("ignoring invalid callback, id:"+d.id+" ("+d.callback+")"):l[d.id].callbacks[d.callback](d.params):d.id?l[d.id]?(d.error?(1,l[d.id].error)(d.error,d.message):d.result!==undefined?(1,l[d.id].success)(d.result):(1,l[d.id].success)(),delete l[d.id],delete f[d.id]):g("ignoring invalid response: "+d.id):c&&k[c]&&k[c](null,d.params)};c(e.window,e.origin,typeof e.scope=="string"?e.scope:"",r);var s=function(a){typeof e.scope=="string"&&e.scope.length&&(a=[e.scope,a].join("::"));return a},t=function(a,b){if(!a)throw"postMessage called with null message";var c=n?"post  ":"queue ";g(c+" message: "+JSON.stringify(a));if(!b&&!n)o.push(a);else{if(typeof e.postMessageObserver=="function")try{e.postMessageObserver(e.origin,a)}catch(d){g("postMessageObserver() raised an exception: "+d.toString())}e.window.postMessage(JSON.stringify(a),e.origin)}},u=function(a,b){g("ready msg received");if(n)throw"received ready message while in ready state.  help!";b==="ping"?j+="-R":j+="-L",v.unbind("__ready"),n=!0,g("ready msg accepted."),b==="ping"&&v.notify({method:"__ready",params:"pong"});while(o.length)t(o.pop());typeof e.onReady=="function"&&e.onReady(v)},v={unbind:function(a){if(k[a]){if(delete k[a])return!0;throw"can't delete method: "+a}return!1},bind:function(a,b){if(!a||typeof a!="string")throw"'method' argument to bind must be string";if(!b||typeof b!="function")throw"callback missing from bind params";if(k[a])throw"method '"+a+"' is already bound!";k[a]=b;return this},call:function(a){if(!a)throw"missing arguments to call function";if(!a.method||typeof a.method!="string")throw"'method' argument to call must be string";if(!a.success||typeof a.success!="function")throw"'success' callback missing from call";var b={},c=[],e=function(a,d){if(typeof d=="object")for(var f in d){if(!d.hasOwnProperty(f))continue;var g=a+(a.length?"/":"")+f;typeof d[f]=="function"?(b[g]=d[f],c.push(g),delete d[f]):typeof d[f]=="object"&&e(g,d[f])}};e("",a.params);var g={id:d,method:s(a.method),params:a.params};c.length&&(g.callbacks=c),a.timeout&&q(d,a.timeout,s(a.method)),l[d]={callbacks:b,error:a.error,success:a.success},f[d]=r,d++,t(g)},notify:function(a){if(!a)throw"missing arguments to notify function";if(!a.method||typeof a.method!="string")throw"'method' argument to notify must be string";t({method:s(a.method),params:a.params})},destroy:function(){b(e.window,e.origin,typeof e.scope=="string"?e.scope:""),window.removeEventListener?window.removeEventListener("message",r,!1):window.detachEvent&&window.detachEvent("onmessage",r),n=!1,k={},m={},l={},e.origin=null,o=[],g("channel destroyed"),j=""}};v.bind("__ready",u),setTimeout(function(){},0);return v}}}();WinChan=function(){function h(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function g(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener&&a.removeEventListener(b,c,!1)}function f(){var a=-1;if(navigator.appName=="Microsoft Internet Explorer"){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(b)!=null&&(a=parseFloat(RegExp.$1))}return a>=8}function e(){try{return d.indexOf("Fennec/")!=-1||d.indexOf("Firefox/")!=-1&&d.indexOf("Android")!=-1}catch(a){}return!1}function c(){return window.JSON&&window.JSON.stringify&&window.JSON.parse&&window.postMessage}function b(a){/^https?:\/\//.test(a)||(a=window.location.href);var b=/^(https?:\/\/[-_a-zA-Z\.0-9:]+)/.exec(a);return b?b[1]:a}function a(){var a=window.location,b=window.opener.frames,c=a.protocol+"//"+a.host;for(i=b.length-1;i>=0;i++)try{if(b[i].location.href.indexOf(c)===0&&b[i].name===j)return b[i]}catch(d){}return}var j="__winchan_relay_frame",k=f();return c()?{open:function(a,c){function f(){l&&document.body.removeChild(l),l=undefined,o&&o.close(),o=undefined}function d(a){try{var b=JSON.parse(a.data);b.a==="ready"?n.postMessage(p,m):b.a==="error"?c&&(c(b.d),c=null):b.a==="response"&&(g(window,"message",d),g(window,"unload",f),f(),c&&(c(null,b.d),c=null))}catch(a){}}if(!c)throw"missing required callback argument";var i;a.url||(i="missing required 'url' parameter"),a.relay_url||(i="missing required 'relay_url' parameter"),i&&setTimeout(function(){c(i)},0);if(!a.window_features||e())a.window_features=undefined;var l,m=b(a.url);if(m!==b(a.relay_url))return setTimeout(function(){c("invalid arguments: origin of url and relay_url must match")},0);var n;k&&(l=document.createElement("iframe"),l.setAttribute("src",a.relay_url),l.style.display="none",l.setAttribute("name",j),document.body.appendChild(l),n=l.contentWindow);var o=window.open(a.url,null,a.window_features);n||(n=o);var p=JSON.stringify({a:"request",d:a.params});h(window,"unload",f),h(window,"message",d);return{close:f,focus:function(){if(o)try{o.focus()}catch(a){}}}}}:{open:function(a,b,c,d){setTimeout(function(){d("unsupported browser")},0)}}}();var b=function(){function i(a,b){k=a,j=b}function h(){var a=-1;if(k.appName=="Microsoft Internet Explorer"){var b=k.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(b)!=null&&(a=parseFloat(RegExp.$1))}return a}function g(){var a=h(),b=a>-1&&a<8;if(b)return"BAD_IE_VERSION"}function f(){return g()}function e(){try{var a="localStorage"in j&&j.localStorage!==null;if(a)j.localStorage.setItem("test","true"),j.localStorage.removeItem("test");else return"LOCALSTORAGE_NOT_SUPPORTED"}catch(b){return"LOCALSTORAGE_DISABLED"}}function d(){if(!j.postMessage)return"POSTMESSAGE_NOT_SUPPORTED"}function c(){if(!(window.JSON&&window.JSON.stringify&&window.JSON.parse))return"JSON_NOT_SUPPORTED"}function b(){l=f()||e()||d()||c();return!l}function a(){return l}var j=window,k=navigator,l;return{setTestEnv:i,isSupported:b,getNoSupportReason:a}}();navigator.id||(navigator.id={});if(!navigator.id.request||navigator.id._shimmed){var c="https://browserid.org",d=navigator.userAgent,e=d.indexOf("Fennec/")!=-1||d.indexOf("Firefox/")!=-1&&d.indexOf("Android")!=-1,f=e?undefined:"menubar=0,location=1,resizable=1,scrollbars=1,status=0,dialog=1,width=700,height=375",g,h={login:null,logout:null,ready:null},j=undefined;function k(a){a!==!0;if(j===undefined)j=a;else if(j!=a)throw"you cannot combine the navigator.id.watch() API with navigator.id.getVerifiedEmail() or navigator.id.get()this site should instead use navigator.id.request() and navigator.id.watch()"}var l;function m(){try{if(!l){var b=window.document,d=b.createElement("iframe");d.style.display="none",b.body.appendChild(d),d.src=c+"/communication_iframe",l=a.build({window:d.contentWindow,origin:c,scope:"mozid_ni",onReady:function(){l.call({method:"loaded",success:function(){h.ready&&h.ready()},error:function(){}})}}),l.bind("logout",function(a,b){h.logout&&h.logout()}),l.bind("login",function(a,b){h.login&&h.login(b)})}}catch(e){l=undefined}}function n(a){if(typeof a=="object"){if(a.onlogin&&typeof a.onlogin!="function"||a.onlogout&&typeof a.onlogout!="function"||a.onready&&typeof a.onready!="function")throw"non-function where function expected in parameters to navigator.id.watch()";h.login=a.onlogin||null,h.logout=a.onlogout||null,h.ready=a.onready||null,m(),typeof a.email!="undefined"&&l&&l.notify({method:"loggedInUser",params:a.email})}}function o(a){if(g)try{g.focus()}catch(d){}else{if(!b.isSupported()){var e=b.getNoSupportReason(),i="unsupported_dialog";e==="LOCALSTORAGE_DISABLED"&&(i="cookies_disabled"),g=window.open(c+"/"+i,null,f);return}l&&l.notify({method:"dialog_running"}),g=WinChan.open({url:c+"/sign_in",relay_url:c+"/relay",window_features:f,params:{method:"get",params:a}},function(b,c){l&&(!b&&c&&c.email&&l.notify({method:"loggedInUser",params:c.email}),l.notify({method:"dialog_complete"})),g=undefined;if(!b&&c&&c.assertion)try{h.login&&h.login(c.assertion)}catch(d){}a&&a.onclose&&a.onclose(),delete a.onclose})}}navigator.id={experimental:{request:function(a){k(!1);return o(a)},watch:function(a){k(!1),n(a)}},logout:function(a){m(),l.notify({method:"logout"}),typeof a=="function"&&setTimeout(a,0)},get:function(a,b){b=b||{},k(!0),n({onlogin:function(b){a&&(a(b),a=null)}}),b.onclose=function(){a&&(a(null),a=null),n({})},b&&b.silent?a&&setTimeout(function(){a(null)},0):o(b)},getVerifiedEmail:function(a){k(!0),navigator.id.get(a)},_shimmed:!0}}})()